###
#   Profile Sync 0.0.3a - a Bash script to sync your
#   linux profile settings to a destination folder.
#   
#   Author: Keith Hand <rkeithhand@gmail.com>
###

#!/bin/bash

configFile=$HOME/.profilesyncconfig

if [ ! -f $configFile ]; then    
    echo "profilesync: no config file found."
    echo
    echo "  --- GENERATING CONFIG FILE ---  "
    echo
    touch $configFile
    echo -n "DESTINATION=\"" >> $configFile
    read -erp "Destination of sync directory: " fileDest
    echo -n $fileDest >> $configFile
    echo "\"" >> $configFile
fi

source $configFile

uploadProfile () {
    eval cp $HOME/.profile $DESTINATION
    eval cp $HOME/.bashrc $DESTINATION
}

downloadProfile () {
    eval cp $DESTINATION/.profile $HOME/
    eval cp $DESTINATION/.bashrc $HOME/
}

helpStatement () {
    echo "Profile Sync 0.0.3a (2018 Nov 17)"
    echo
    echo "usage: profilesync [argument]"
    echo
    echo "Arguments:"
    echo -e "    -u, --upload\tUploads current profile to Destination directory"
    echo -e "    -d, --download\tDownloads current profile from Destination directory"
    echo -e "    --help\t\tDisplays this menu and exits"
}

defaultCommandError () {
    echo "profilesync: unknown parameter entered."
    echo "Try 'profilesync --help' for more information"
}

noParamError () {
    echo "profilesync: no parameter entered."
    echo "Try 'profilesync --help' for more information"
}

excessParamError () {
    echo "profilesync: too many parameters entered."
    echo "Try 'profilesync --help' for more information"
}

if [ -n "$2" ]; then
    excessParamError
    exit
fi

if [ -n "$1" ]; then
    while [ -n "$1" ]; do
        case "$1" in
        -u|--upload)    uploadProfile ;;
        -d|--download)  downloadProfile ;;
        --help)         helpStatement ;;
        *)              defaultCommandError ;;
        esac
        shift
        break
    done
else
    noParamError
fi
